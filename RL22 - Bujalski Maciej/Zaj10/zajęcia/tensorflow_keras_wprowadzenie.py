# -*- coding: utf-8 -*-
"""TensorFlow_Keras_wprowadzenie.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ltZgVJpnsuZq-WsXG3JI5__Vk2JuinQQ

# Przykład 1 (liczenie gradientu)
"""

import tensorflow as tf

"""![image.png](data:image/png;base64,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)"""

x = tf.Variable(4.0)

with tf.GradientTape() as tape:
    f = 2*(x**2)+3*x+4            
    df_dx = tape.gradient(f,x)

df_dx.numpy()

"""![image.png](data:image/png;base64,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)"""

x = tf.Variable(4.0)
y = tf.Variable(5.0)

with tf.GradientTape() as tape:
    f = 2*(x**3)+3*(y**2)+4                         
    df_dx,df_dy = tape.gradient(f,(x,y))

print(df_dx.numpy())
print(df_dy.numpy())

"""# Przykład 2 (regresja liniowa - liczenie gradientów)"""

import matplotlib.pyplot as plt 
import numpy as np

"""Wygenrujemy **zbiór danych** złożony z 1000 punktów."""

number_of_points = 1000
x_point = []
y_point = []

a = 0.22
b = 0.78

for i in range(number_of_points):
    x = np.random.normal(0.0,0.5)
    y = (a*x+b)+np.random.normal(0.0,0.1)
    x_point.append(x)
    y_point.append(y)

plt.scatter(x_point,y_point,c='b')
plt.show()

real_x = np.array(x_point)
real_y = np.array(y_point)

"""Definicja błędu:"""

def loss_fn(real_y, pred_y):
    return tf.reduce_mean((real_y - pred_y)**2)

"""Defincje parametrów modelu:"""

import random
a = tf.Variable(random.random())
b = tf.Variable(random.random())

"""Pętla treningowa:"""

Loss = []
epochs = 50

for _ in range(epochs):
  with tf.GradientTape() as tape:
    pred_y = a * real_x + b
    loss = loss_fn(real_y, pred_y)
    Loss.append(loss.numpy())

  dloss_da, dloss_db = tape.gradient(loss,(a, b))

  a.assign_sub(dloss_da * 0.1)  #a = a - alpha*dloss_da
  b.assign_sub(dloss_db * 0.1)  #b = b - alpha*dloss_db

np.max(Loss),np.min(Loss)

print(a.numpy())
print(b.numpy())

plt.scatter(np.arange(epochs),Loss)
plt.show()

max = np.max(x_point)
min = np.min(x_point)

X = np.linspace(min, max, num=10)
plt.plot(X,a.numpy()*X+b.numpy(),c='r')
plt.scatter(x_point,y_point,c="b")
plt.show()

"""# Przykład 3 (regresja liniowa - Keras)"""

import keras
from keras.models import Sequential
from keras.layers import Dense

"""Definiujemy model:"""

model = Sequential()

"""Dodajemy **jedną warstwę** (Dense) z **jednym neuronem** (units=1) z **biasem** (use_bias=True) i **liniową funkcją aktywacji** (activation="linear"):"""

model.add(Dense(units = 1, use_bias=True, input_dim=1, activation = "linear"))

"""Definiujemy **optymalizator** i **błąd** (średni błąd kwadratowy - MSE). **Współczynnik uczenia = 0.1**"""

opt = tf.keras.optimizers.Adam(learning_rate=0.1)

"""Kompilacja modelu:"""

model.compile(loss='MSE',optimizer=opt)

"""Informacje o modelu:"""

model.summary()

"""Ustalamy **liczbę epok** w czasie której **model będzie uczony**."""

number_epochs=100

"""Proces **uczenia**:"""

h = model.fit(real_x,real_y, verbose=0, epochs=number_epochs, batch_size=1000)

Loss = h.history['loss']

plt.scatter(np.arange(number_epochs),Loss)
plt.show()

"""Sprawdźmy jakie są **wartości wag**:"""

weights = model.get_weights()

a = weights[0][0][0]
b = weights[1][0]    #bias

a,b

max = np.max(x_point)
min = np.min(x_point)

X = np.linspace(min, max, num=10)
plt.plot(X,a*X+b,c='r')
plt.scatter(x_point,y_point,c="b")
plt.show()

"""# Przykład 4 (regresja logistyczna - liczenie gradientów)

Zbiór danych:
"""

x_label1 = np.random.normal(3, 1, 1000)
y_label1 = np.random.normal(2, 1, 1000) 
x_label2 = np.random.normal(7, 1, 1000)
y_label2 = np.random.normal(6, 1, 1000)

xs = np.append(x_label1, x_label2)
ys = np.append(y_label1, y_label2) 
labels = np.asarray([0.]*len(x_label1)+[1.]*len(x_label2))

plt.scatter(x_label1, y_label1, c='r', marker='x', s=20)
plt.scatter(x_label2, y_label2, c='g', marker='1', s=20)
plt.show()

"""Definiujemy funkcję błędu (entropia krzyżowa):"""

def loss_fn(label, label_model):
    return tf.reduce_mean(-label*tf.math.log(label_model)-(1-label)*tf.math.log(1-label_model))

"""Parametry modelu:"""

import random
a = tf.Variable(random.random())
b = tf.Variable(random.random())
c = tf.Variable(random.random())

"""Pętla treningowa:"""

Loss = []
epochs = 2000
lr = 0.01
for _ in range(epochs):
  with tf.GradientTape() as tape:
    labels_model = tf.sigmoid(a*xs + b*ys + c)
    
    loss = loss_fn(labels, labels_model)
    Loss.append(loss.numpy())

  dloss_da, dloss_db, dloss_dc = tape.gradient(loss,(a, b, c))

  a.assign_sub(lr*dloss_da)
  b.assign_sub(lr*dloss_db)
  c.assign_sub(lr*dloss_dc)

np.max(Loss),np.min(Loss)

print(a.numpy())
print(b.numpy())
print(c.numpy())

plt.scatter(np.arange(epochs),Loss)
plt.show()

"""Sprawdzamy dla pewnego punktu:"""

x=8.0
y=6.0 
plt.scatter(x_label1, y_label1, c='r', marker='x', s=20)
plt.scatter(x_label2, y_label2, c='g', marker='1', s=20)
plt.scatter([x],[y],c='b', marker='s')
plt.show()

tf.sigmoid(a*x + b*y + c).numpy()

"""# Przykład 5 (regresja logistyczna - Keras)

Zbiór danych:
"""

#zbiór czerowny
x_label1 = np.random.normal(3, 1, 1000)
y_label1 = np.random.normal(2, 1, 1000) 

#zbiór zielony
x_label2 = np.random.normal(7, 1, 1000)
y_label2 = np.random.normal(6, 1, 1000)

xs = np.append(x_label1, x_label2)
ys = np.append(y_label1, y_label2)

plt.scatter(x_label1, y_label1, c='r', marker='x', s=20)
plt.scatter(x_label2, y_label2, c='g', marker='1', s=20)
plt.show()

"""Zbiór treningowy złożony jest z punktów:"""

xs = xs.reshape(-1,1)
ys = ys.reshape(-1,1)
data_points = np.concatenate([xs,ys],axis=1)
data_points

"""Wartości oczekiwane: **0** dla zbioru **czerwonego**,**1** dla zbioru **zielonego**."""

labels = np.asarray([0.]*len(x_label1)+[1.]*len(x_label2))
labels

data_points.shape,labels.shape

"""Definiujemy model:"""

model = Sequential()
model.add(Dense(units = 1, use_bias=True, input_dim=2, activation = "sigmoid"))

opt = tf.keras.optimizers.Adam(learning_rate=0.1)
#opt = keras.optimizers.SGD(learning_rate=0.001)

model.compile(loss='binary_crossentropy',optimizer=opt,metrics=['accuracy'])
model.summary()

"""Pętla ucząca:"""

epochs = 1000
h = model.fit(data_points,labels, verbose=0, epochs=epochs, batch_size=100)

Loss = h.history['loss']

plt.scatter(np.arange(epochs),Loss)
plt.show()

"""Sprawdzamy dla punktu o współrzędnych:"""

x=7.0
y=6.0

plt.scatter(x_label1, y_label1, c='r', marker='x', s=20)
plt.scatter(x_label2, y_label2, c='g', marker='1', s=20)
plt.scatter([x],[y],c='b', marker='s')
plt.show()

model.predict([[x,y]])